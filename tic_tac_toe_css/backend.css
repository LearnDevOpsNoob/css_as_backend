/* RESET + BASIC LAYOUT */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: sans-serif;
  background: #222;
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
}

.app {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  align-items: center;
}

h1 {
  font-size: 2rem;
  font-weight: bold;
}

/* BOARD GRID */
.board {
  display: grid;
  grid-template-columns: repeat(3, 100px);
  grid-template-rows: repeat(3, 100px);
  gap: 5px;
  position: relative;
}

/* CELLS */
.cell {
  background: #333;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
}

/* Hide radio inputs */
.cell input {
  display: none;
}

/* MARKS */
.mark {
  font-size: 2.5rem;
  font-weight: bold;
  pointer-events: none;
}

#c1-x:checked ~ .mark::before,
#c2-x:checked ~ .mark::before,
#c3-x:checked ~ .mark::before,
#c4-x:checked ~ .mark::before,
#c5-x:checked ~ .mark::before,
#c6-x:checked ~ .mark::before,
#c7-x:checked ~ .mark::before,
#c8-x:checked ~ .mark::before,
#c9-x:checked ~ .mark::before {
  content: "X";
  color: #ff4c4c;
}

#c1-o:checked ~ .mark::before,
#c2-o:checked ~ .mark::before,
#c3-o:checked ~ .mark::before,
#c4-o:checked ~ .mark::before,
#c5-o:checked ~ .mark::before,
#c6-o:checked ~ .mark::before,
#c7-o:checked ~ .mark::before,
#c8-o:checked ~ .mark::before,
#c9-o:checked ~ .mark::before {
  content: "O";
  color: #4cff4c;
}

/* CLICKABLE LABELS */
.cell label {
  position: absolute;
  width: 100%;
  height: 100%;
  cursor: pointer;
}

/* --- FIXED TURN CONTROL --- */
.app:has(#turn-x:checked) .board .cell:not(:has(input:checked)) .tap-x {
  pointer-events: auto;
}
.app:has(#turn-x:checked) .board .cell:not(:has(input:checked)) .tap-o {
  pointer-events: none;
}

.app:has(#turn-o:checked) .board .cell:not(:has(input:checked)) .tap-o {
  pointer-events: auto;
}
.app:has(#turn-o:checked) .board .cell:not(:has(input:checked)) .tap-x {
  pointer-events: none;
}

/* Once a mark is placed, lock cell */
.cell:has(input:checked) label {
  pointer-events: none !important;
}

/* OVERLAYS */
.overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: calc(100% + 0px);
  height: calc(100% + 0px);
  background: rgba(0, 0, 0, 0.85);
  display: none;
  place-items: center;
  font-size: 2rem;
  font-weight: bold;
}

/* WIN CONDITIONS - scoped to .board */
.board:has(#c1-x:checked):has(#c2-x:checked):has(#c3-x:checked) .xwin,
.board:has(#c4-x:checked):has(#c5-x:checked):has(#c6-x:checked) .xwin,
.board:has(#c7-x:checked):has(#c8-x:checked):has(#c9-x:checked) .xwin,
.board:has(#c1-x:checked):has(#c4-x:checked):has(#c7-x:checked) .xwin,
.board:has(#c2-x:checked):has(#c5-x:checked):has(#c8-x:checked) .xwin,
.board:has(#c3-x:checked):has(#c6-x:checked):has(#c9-x:checked) .xwin,
.board:has(#c1-x:checked):has(#c5-x:checked):has(#c9-x:checked) .xwin,
.board:has(#c3-x:checked):has(#c5-x:checked):has(#c7-x:checked) .xwin {
  display: grid;
}

.board:has(#c1-o:checked):has(#c2-o:checked):has(#c3-o:checked) .owin,
.board:has(#c4-o:checked):has(#c5-o:checked):has(#c6-o:checked) .owin,
.board:has(#c7-o:checked):has(#c8-o:checked):has(#c9-o:checked) .owin,
.board:has(#c1-o:checked):has(#c4-o:checked):has(#c7-o:checked) .owin,
.board:has(#c2-o:checked):has(#c5-o:checked):has(#c8-o:checked) .owin,
.board:has(#c3-o:checked):has(#c6-o:checked):has(#c9-o:checked) .owin,
.board:has(#c1-o:checked):has(#c5-o:checked):has(#c9-o:checked) .owin,
.board:has(#c3-o:checked):has(#c5-o:checked):has(#c7-o:checked) .owin {
  display: grid;
}

/* DRAW condition - fixed */
.board:not(:has(.xwin)):not(:has(.owin))
  :has(#c1-x:checked, #c1-o:checked)
  :has(#c2-x:checked, #c2-o:checked)
  :has(#c3-x:checked, #c3-o:checked)
  :has(#c4-x:checked, #c4-o:checked)
  :has(#c5-x:checked, #c5-o:checked)
  :has(#c6-x:checked, #c6-o:checked)
  :has(#c7-x:checked, #c7-o:checked)
  :has(#c8-x:checked, #c8-o:checked)
  :has(#c9-x:checked, #c9-o:checked) .draw {
  display: grid;
}

/* OVERLAY COLORS */
.xwin { color: #ff4c4c; }
.owin { color: #4cff4c; }
.draw { color: #ffc107; }
